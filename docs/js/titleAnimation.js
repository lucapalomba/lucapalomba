class TitleAnimator { constructor() { this.titleElement = document.querySelector('.hero-title'); this.INTRO_ANIMATION_DURATION = 2000; this.SWAP_DELAY = 500; this.TYPEWRITER_SPEED = 100; this.ERASE_SPEED = 60; this.isAnimating = false; this.currentLanguage = document.documentElement.lang || 'en'; this.keySound = null; this.init(); } init() { if (!this.titleElement) return; this.keySound = new Audio('sounds/keyboard-click.mp3'); this.keySound.preload = 'auto'; this.keySound.volume = 0.2; this.titleElement.style.cursor = 'pointer'; this.titleElement.addEventListener('click', () => { if (!this.isAnimating) { this.resetAndAnimate(); } }); setTimeout(() => { this.startAnimation(); }, this.INTRO_ANIMATION_DURATION); } startAnimation() { setTimeout(() => { this.swapTitle(); }, this.SWAP_DELAY); } resetAndAnimate() { const originalText = this.getOriginalText(this.currentLanguage); this.titleElement.textContent = originalText; setTimeout(() => { this.startAnimation(); }, this.INTRO_ANIMATION_DURATION); } swapTitle() { if (!this.titleElement) return; this.currentLanguage = document.documentElement.lang || 'en'; let originalText, newText; if (this.currentLanguage === 'en') { originalText = 'I build things for the web.'; newText = 'I build teams for Companies.'; } else if (this.currentLanguage === 'it') { originalText = 'Costruisco cose per il web.'; newText = 'Costruisco team per le Aziende.'; } else { return; } if (this.titleElement.textContent.trim() !== originalText) { return; } this.eraseText(() => { this.typeNewText(newText, this.currentLanguage); }); } getOriginalText(language) { if (language === 'en') { return 'I build things for the web.'; } else if (language === 'it') { return 'Costruisco cose per il web.'; } return 'I build things for the web.'; } eraseText(callback) { this.isAnimating = true; const originalText = this.titleElement.textContent; let position = originalText.length; const eraseInterval = setInterval(() => { position--; this.titleElement.textContent = originalText.substring(0, position); if (originalText[position] !== ' ') { this.playKeySound(); } if (position === 0) { clearInterval(eraseInterval); callback(); } }, this.ERASE_SPEED); } typeNewText(fullText, language) { let position = 0; const textArray = this.getTextArray(fullText, language); const typeInterval = setInterval(() => { if (position < textArray.length) { if (textArray[position].char !== ' ' && this.keySound) { this.playKeySound(); } this.updateContent(textArray.slice(0, position + 1)); position++; } else { clearInterval(typeInterval); this.updateContent(textArray); this.isAnimating = false; } }, this.TYPEWRITER_SPEED); } playKeySound() { try { if (!this.keySound) return; const sound = this.keySound.cloneNode(); sound.currentTime = 0; sound.volume = 0.4; const playPromise = sound.play(); if (playPromise !== undefined) { playPromise.catch(err => { console.debug('Could not play keyboard sound:', err.message); }); } } catch (e) { console.debug('Error playing keyboard sound:', e.message); } } getTextArray(text, language) { const highlightedWords = this.getHighlightedWords(language); const result = []; let charIndex = 0; for (let i = 0; i < text.length; i++) { const char = text[i]; let isHighlighted = false; for (const word of highlightedWords) { const wordIndex = text.indexOf(word); if (wordIndex !== -1 && i >= wordIndex && i < wordIndex + word.length) { isHighlighted = true; break; } } result.push({ char, isHighlighted }); } return result; } getHighlightedWords(language) { if (language === 'en') { return ['teams', 'Companies']; } else if (language === 'it') { return ['team', 'Aziende']; } return []; } updateContent(textArray) { let html = ''; let currentHighlight = false; let buffer = ''; for (let i = 0; i < textArray.length; i++) { const item = textArray[i]; const nextItem = textArray[i + 1]; const isNextHighlighted = nextItem ? nextItem.isHighlighted : false; if (item.isHighlighted && !currentHighlight) { if (buffer) { html += buffer; buffer = ''; } html += '<span class="highlight">' + item.char; currentHighlight = true; } else if (!item.isHighlighted && currentHighlight) { html += '</span>' + item.char; currentHighlight = false; } else if (item.isHighlighted && currentHighlight) { html += item.char; } else { buffer += item.char; } } if (buffer) { html += buffer; } if (currentHighlight) { html += '</span>'; } this.titleElement.innerHTML = html; } } document.addEventListener('DOMContentLoaded', function() { new TitleAnimator(); });